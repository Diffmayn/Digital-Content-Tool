<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Photo Order Management System</title>
    <meta name="description" content="Professional photo order management system for photographers and studios">
    
    <!-- Stylesheets -->
    <link rel="stylesheet" href="css/main.css">
    
    <!-- Configuration (Must load first) -->
    <script src="config/app.config.js"></script>
</head>
<body>
    <div class="efficient-pro-layout">
        <!-- Compact Sidebar -->
        <aside class="sidebar-compact">
            <div class="logo-compact">PO</div>
            <nav class="nav-icons">
                <button class="nav-icon active" title="Dashboard" data-view="dashboard">üìä</button>
                <button class="nav-icon" title="Orders" data-view="orders">üìã</button>
                <button class="nav-icon" title="Photographers">üì∏</button>
                <button class="nav-icon" title="Studios">üè¢</button>
                <button class="nav-icon" title="Analytics">üìà</button>
                <button class="nav-icon" title="Reports">üìÑ</button>
                <button class="nav-icon" title="Settings">‚öôÔ∏è</button>
            </nav>
            <div class="sidebar-bottom">
                <div id="userInfo" class="user-info"></div>
                <button class="nav-icon user-icon" id="logoutBtn" title="Logout" style="display: none;">üö™</button>
            </div>
        </aside>

        <!-- Main Content Area -->
        <main class="main-efficient-pro">
            <!-- Top Toolbar -->
            <div class="toolbar">
                <div class="toolbar-left">
                    <h1>Photo Order Management</h1>
                    <span class="view-label">Production System v1.0</span>
                </div>
                <div class="toolbar-right">
                    <input type="search" class="search-box" id="globalSearch" placeholder="Search across all fields...">
                    <button class="tool-btn" id="exportBtn" title="Export to CSV">üìä Export</button>
                    <button class="tool-btn" id="refreshBtn" title="Refresh data">üîÑ Refresh</button>
                    <button class="tool-btn primary" id="newOrderBtn" title="Create new order">+ New Order</button>
                </div>
            </div>

            <!-- Metrics Bar -->
            <div class="metrics-bar">
                <div class="metric">
                    <span class="metric-icon">üìã</span>
                    <div>
                        <span class="metric-label">Total Orders</span>
                        <span class="metric-value" id="totalOrders">0</span>
                    </div>
                </div>
                <div class="metric">
                    <span class="metric-icon">‚è≥</span>
                    <div>
                        <span class="metric-label">Pending</span>
                        <span class="metric-value" id="pendingOrders">0</span>
                    </div>
                </div>
                <div class="metric">
                    <span class="metric-icon">üîÑ</span>
                    <div>
                        <span class="metric-label">In Progress</span>
                        <span class="metric-value" id="inProgressOrders">0</span>
                    </div>
                </div>
                <div class="metric">
                    <span class="metric-icon">‚úÖ</span>
                    <div>
                        <span class="metric-label">Completed</span>
                        <span class="metric-value" id="completedOrders">0</span>
                    </div>
                </div>
                <div class="metric">
                    <span class="metric-icon">‚ö†Ô∏è</span>
                    <div>
                        <span class="metric-label">Alerts</span>
                        <span class="metric-value alert" id="alertOrders">0</span>
                    </div>
                </div>
            </div>

            <!-- Filter Panel -->
            <div class="filter-panel" id="filterPanel">
                <div class="filter-header">
                    <h3>üîç Filters</h3>
                    <div class="filter-actions">
                        <button class="filter-btn" id="applyFiltersBtn">Apply</button>
                        <button class="filter-btn secondary" id="clearFiltersBtn">Clear All</button>
                    </div>
                </div>
                <div class="filter-content" id="filterContent">
                    <div class="filter-grid">
                        <!-- Status Filter -->
                        <div class="filter-group">
                            <label>Status</label>
                            <select id="filterStatus" data-filter="status">
                                <option value="">All</option>
                                <option value="Pending">Pending</option>
                                <option value="In Progress">In Progress</option>
                                <option value="Completed">Completed</option>
                                <option value="Cancelled">Cancelled</option>
                            </select>
                        </div>

                        <!-- Group Filter -->
                        <div class="filter-group">
                            <label>Group</label>
                            <select id="filterGroup" data-filter="group">
                                <option value="">All</option>
                                <option value="Marketing">Marketing</option>
                                <option value="Product">Product</option>
                                <option value="Event">Event</option>
                                <option value="Editorial">Editorial</option>
                                <option value="Social">Social</option>
                            </select>
                        </div>

                        <!-- Event Filter -->
                        <div class="filter-group">
                            <label>Event (Format: A[Week][Year][Format])</label>
                            <select id="filterEvent" data-filter="event">
                                <option value="">All Events</option>
                                <option value="A5224052">A5224052 - Week 52, 2024, BILKA</option>
                                <option value="A0125052">A0125052 - Week 01, 2025, BILKA</option>
                                <option value="A1025052">A1025052 - Week 10, 2025, BILKA</option>
                                <option value="A2025022">A2025022 - Week 20, 2025, F√∏tex</option>
                                <option value="A4724052">A4724052 - Week 47, 2024, BILKA</option>
                                <option value="A4824070">A4824070 - Week 48, 2024, Netto</option>
                                <option value="A3225052">A3225052 - Week 32, 2025, BILKA</option>
                                <option value="A2225022">A2225022 - Week 22, 2025, F√∏tex</option>
                                <option value="A2825070">A2825070 - Week 28, 2025, Netto</option>
                                <option value="A4024052">A4024052 - Week 40, 2024, BILKA</option>
                                <option value="A1525022">A1525022 - Week 15, 2025, F√∏tex</option>
                                <option value="A3525070">A3525070 - Week 35, 2025, Netto</option>
                            </select>
                        </div>

                        <!-- Type Filter -->
                        <div class="filter-group">
                            <label>Type</label>
                            <select id="filterType" data-filter="type">
                                <option value="">All</option>
                                <option value="Portrait">Portrait</option>
                                <option value="Product">Product</option>
                                <option value="Landscape">Landscape</option>
                                <option value="Macro">Macro</option>
                                <option value="Studio">Studio</option>
                                <option value="Lifestyle">Lifestyle</option>
                            </select>
                        </div>

                        <!-- Photographer Filter -->
                        <div class="filter-group">
                            <label>Photographer/Method</label>
                            <select id="filterPhotographer" data-filter="photographer">
                                <option value="">All</option>
                                <option value="Sarah Johnson">Sarah Johnson</option>
                                <option value="Mike Chen">Mike Chen</option>
                                <option value="Emma Davis">Emma Davis</option>
                                <option value="Photo Box">Photo Box</option>
                                <option value="Generative AI">Generative AI</option>
                                <option value="Post-Processing">Post-Processing</option>
                            </select>
                        </div>

                        <!-- Purchase Group Filter -->
                        <div class="filter-group">
                            <label>Purchase Group</label>
                            <input type="text" id="filterPurchaseGroup" data-filter="purchasingGroup" placeholder="e.g., 112">
                        </div>

                        <!-- Date Range Filter -->
                        <div class="filter-group">
                            <label>Deadline From</label>
                            <input type="date" id="filterDateFrom" data-filter="deadlineFrom">
                        </div>

                        <div class="filter-group">
                            <label>Deadline To</label>
                            <input type="date" id="filterDateTo" data-filter="deadlineTo">
                        </div>

                        <!-- Article Name Filter -->
                        <div class="filter-group">
                            <label>Article Name</label>
                            <input type="text" id="filterArticleName" data-filter="articleName" placeholder="Search articles...">
                        </div>
                    </div>
                </div>
            </div>

            <!-- Data Table Container -->
            <div class="table-container">
                <div class="table-wrapper">
                    <table class="data-table" id="ordersTable">
                        <thead>
                            <tr>
                                <th style="width: 30px;"></th><!-- Expand/Collapse -->
                                <th class="sortable" data-sort="orderNumber">Order #</th>
                                <th class="sortable" data-sort="page">Page</th>
                                <th class="sortable" data-sort="offerID">Offer ID</th>
                                <th class="sortable" data-sort="group">Group</th>
                                <th class="sortable" data-sort="offerName">Offer Name</th>
                                <th class="sortable" data-sort="type">Type</th>
                                <th class="sortable" data-sort="photographer">Photographer</th>
                                <th class="sortable" data-sort="principle">Principle</th>
                                <th>Preview</th>
                                <th>Dialog</th>
                                <th class="sortable" data-sort="status">Status</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="ordersTableBody">
                            <!-- Table rows will be dynamically generated -->
                            <tr>
                                <td colspan="13" style="text-align: center; padding: 40px; color: #7f8c8d;">
                                    <div>Loading orders...</div>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- Pagination -->
            <div class="pagination-bar">
                <div class="pagination-info">
                    Showing <span id="showingStart">0</span> to <span id="showingEnd">0</span> of <span id="totalFiltered">0</span> orders
                </div>
                <div class="pagination-controls">
                    <button class="page-btn" id="prevPage" disabled>‚Üê Previous</button>
                    <div id="pageNumbers" class="page-numbers"></div>
                    <button class="page-btn" id="nextPage">Next ‚Üí</button>
                </div>
                <div class="pagination-size">
                    <label>Per page:</label>
                    <select id="pageSize">
                        <option value="10">10</option>
                        <option value="25" selected>25</option>
                        <option value="50">50</option>
                        <option value="100">100</option>
                    </select>
                </div>
            </div>
        </main>
    </div>

    <!-- Modal for Order Details -->
    <div id="orderModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Order Details</h2>
                <button class="modal-close" onclick="closeModal()">&times;</button>
            </div>
            <div class="modal-body" id="orderModalBody">
                <!-- Order details will be dynamically loaded -->
            </div>
        </div>
    </div>

    <!-- Modal for Creating New Order -->
    <div id="createOrderModal" class="modal">
        <div class="modal-content" style="max-width: 900px;">
            <div class="modal-header">
                <h2>Create New Photo Order</h2>
                <button class="modal-close" onclick="closeCreateOrderModal()">&times;</button>
            </div>
            <div class="modal-body">
                <form id="createOrderForm">
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px;">
                        <!-- Left Column -->
                        <div>
                            <h3 style="margin-top: 0; color: #495057;">Article Information</h3>
                            
                            <div class="form-group">
                                <label>Article ID *</label>
                                <input type="text" id="newArticleId" required style="width: 100%; padding: 8px; border: 1px solid #ced4da; border-radius: 4px;">
                            </div>

                            <div class="form-group">
                                <label>Article Name *</label>
                                <input type="text" id="newArticleName" required style="width: 100%; padding: 8px; border: 1px solid #ced4da; border-radius: 4px;">
                            </div>

                            <div class="form-group">
                                <label>Purchase Group *</label>
                                <input type="text" id="newPurchaseGroup" required placeholder="e.g., 112 - Footwear" style="width: 100%; padding: 8px; border: 1px solid #ced4da; border-radius: 4px;">
                            </div>

                            <div class="form-group">
                                <label>Content Type *</label>
                                <select id="newContentType" required style="width: 100%; padding: 8px; border: 1px solid #ced4da; border-radius: 4px;">
                                    <option value="E-commerce">E-commerce</option>
                                    <option value="Marketing">Marketing</option>
                                    <option value="Social Media">Social Media</option>
                                    <option value="Editorial">Editorial</option>
                                    <option value="Product">Product</option>
                                </select>
                            </div>

                            <div class="form-group">
                                <label>DAM Shot Type *</label>
                                <select id="newDamShotType" required style="width: 100%; padding: 8px; border: 1px solid #ced4da; border-radius: 4px;">
                                    <option value="Studio">Studio</option>
                                    <option value="Lifestyle">Lifestyle</option>
                                    <option value="On-location">On-location</option>
                                    <option value="Macro">Macro</option>
                                    <option value="360¬∞">360¬∞</option>
                                    <option value="Environmental">Environmental</option>
                                </select>
                            </div>

                            <div class="form-group">
                                <label>Activity *</label>
                                <input type="text" id="newActivity" required placeholder="e.g., A5252052" style="width: 100%; padding: 8px; border: 1px solid #ced4da; border-radius: 4px;">
                            </div>

                            <div class="form-group">
                                <label>
                                    <input type="checkbox" id="newGrouped" style="width: auto; margin-right: 8px;">
                                    Grouped (multiple articles for single shoot)
                                </label>
                            </div>
                        </div>

                        <!-- Right Column -->
                        <div>
                            <h3 style="margin-top: 0; color: #495057;">Photography Details</h3>
                            
                            <div class="form-group">
                                <label>Photographer *</label>
                                <select id="newPhotographer" required style="width: 100%; padding: 8px; border: 1px solid #ced4da; border-radius: 4px;">
                                    <option value="John Smith">John Smith</option>
                                    <option value="Mike Chen">Mike Chen</option>
                                    <option value="Emma Davis">Emma Davis</option>
                                    <option value="Photo Box">Photo Box</option>
                                    <option value="Maria Garcia">Maria Garcia</option>
                                    <option value="Studio A">Studio A</option>
                                    <option value="Studio C">Studio C</option>
                                    <option value="Alex Rodriguez">Alex Rodriguez</option>
                                    <option value="Post-Processing">Post-Processing</option>
                                    <option value="Generative AI">Generative AI</option>
                                </select>
                            </div>

                            <div class="form-group">
                                <label>Sample Delivery *</label>
                                <input type="date" id="newSampleDelivery" required style="width: 100%; padding: 8px; border: 1px solid #ced4da; border-radius: 4px;">
                            </div>

                            <div class="form-group">
                                <label>Deadline *</label>
                                <input type="date" id="newDeadline" required style="width: 100%; padding: 8px; border: 1px solid #ced4da; border-radius: 4px;">
                            </div>

                            <div class="form-group">
                                <label>File Name *</label>
                                <input type="text" id="newFileName" required placeholder="e.g., ENV_00091234" style="width: 100%; padding: 8px; border: 1px solid #ced4da; border-radius: 4px;">
                            </div>

                            <div class="form-group">
                                <label>Upload Time</label>
                                <input type="datetime-local" id="newUploadTime" style="width: 100%; padding: 8px; border: 1px solid #ced4da; border-radius: 4px;">
                                <small style="color: #6c757d; font-size: 11px;">Leave empty for current time</small>
                            </div>

                            <div class="form-group">
                                <label>Status *</label>
                                <select id="newStatus" required style="width: 100%; padding: 8px; border: 1px solid #ced4da; border-radius: 4px;">
                                    <option value="Pending">Pending</option>
                                    <option value="In Progress">In Progress</option>
                                    <option value="Completed">Completed</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <!-- Briefing Section -->
                    <div style="margin-top: 20px;">
                        <h3 style="margin-top: 0; color: #495057;">Detailed Briefing</h3>
                        <div class="form-group">
                            <label>Briefing *</label>
                            <textarea id="newBriefing" required rows="4" placeholder="Provide detailed instructions for the photographer..." style="width: 100%; padding: 10px; border: 1px solid #ced4da; border-radius: 4px; resize: vertical; font-family: inherit;"></textarea>
                        </div>
                    </div>

                    <!-- Form Actions -->
                    <div style="margin-top: 30px; display: flex; gap: 10px; justify-content: flex-end; border-top: 1px solid #dee2e6; padding-top: 20px;">
                        <button type="button" onclick="closeCreateOrderModal()" style="padding: 10px 20px; background: #6c757d; color: white; border: none; border-radius: 4px; cursor: pointer;">Cancel</button>
                        <button type="submit" style="padding: 10px 20px; background: #007bff; color: white; border: none; border-radius: 4px; cursor: pointer;">Create Order</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- Scripts (Load in specific order) -->
    <!-- 1. Services -->
    <script src="js/auth.service.js"></script>
    <script src="js/api.service.js"></script>
    
    <!-- 2. Mock Data Generator (from efficient-pro.js) -->
    <script src="efficient-pro.js"></script>
    
    <!-- 3. Main Application -->
    <script src="js/app.main.js"></script>

    <!-- Development Console Info -->
    <script>
        if (AppConfig.debug.enabled) {
            console.log('%c==============================================', 'color: #3498db');
            console.log('%c  Photo Order Management System', 'font-size: 18px; font-weight: bold; color: #2c3e50');
            console.log('%c  Version: ' + AppConfig.app.version, 'color: #27ae60');
            console.log('%c  Environment: ' + AppConfig.app.environment, 'color: #e74c3c');
            console.log('%c  Authentication: ' + (AppConfig.auth.enabled ? 'Enabled' : 'Disabled'), 'color: #f39c12');
            console.log('%c==============================================', 'color: #3498db');
            console.log('');
            console.log('%cAvailable Commands:', 'font-weight: bold');
            console.log('  app.refresh() - Refresh data');
            console.log('  app.exportData() - Export to CSV');
            console.log('  authService.logout() - Logout (if auth enabled)');
            console.log('  apiService.clearAllData() - Clear all data');
            console.log('');
        }

        // Helper function to close modal
        function closeModal() {
            document.getElementById('orderModal').classList.remove('active');
        }

        // Helper function to close create order modal
        function closeCreateOrderModal() {
            document.getElementById('createOrderModal').classList.remove('active');
            document.getElementById('createOrderForm').reset();
        }

        // Counter for article fields
        let articleCounter = 0;

        // Add article field to the form
        function addArticleField() {
            articleCounter++;
            const container = document.getElementById('articlesContainer');
            const articleDiv = document.createElement('div');
            articleDiv.className = 'article-field';
            articleDiv.id = `article-${articleCounter}`;
            articleDiv.style.cssText = 'border: 1px solid #dee2e6; padding: 15px; margin-bottom: 15px; border-radius: 4px; position: relative;';
            
            articleDiv.innerHTML = `
                <button type="button" onclick="removeArticleField(${articleCounter})" style="position: absolute; top: 10px; right: 10px; background: #dc3545; color: white; border: none; padding: 5px 10px; border-radius: 4px; cursor: pointer; font-size: 12px;">Remove</button>
                <h4 style="margin-top: 0; color: #495057;">Article ${articleCounter}</h4>
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px;">
                    <div>
                        <div class="form-group">
                            <label>Article Number *</label>
                            <input type="text" name="articleNo_${articleCounter}" required style="width: 100%; padding: 8px; border: 1px solid #ced4da; border-radius: 4px;">
                        </div>
                        <div class="form-group">
                            <label>Article Name *</label>
                            <input type="text" name="articleName_${articleCounter}" required style="width: 100%; padding: 8px; border: 1px solid #ced4da; border-radius: 4px;">
                        </div>
                        <div class="form-group">
                            <label>Unit of Measure *</label>
                            <select name="unitOfMeasure_${articleCounter}" required style="width: 100%; padding: 8px; border: 1px solid #ced4da; border-radius: 4px;">
                                <option value="EA">EA (Each)</option>
                                <option value="KG">KG (Kilogram)</option>
                                <option value="L">L (Liter)</option>
                                <option value="PC">PC (Piece)</option>
                            </select>
                        </div>
                    </div>
                    <div>
                        <div class="form-group">
                            <label>Net Content *</label>
                            <input type="text" name="netContent_${articleCounter}" required placeholder="e.g., 1 EA" style="width: 100%; padding: 8px; border: 1px solid #ced4da; border-radius: 4px;">
                        </div>
                        <div class="form-group">
                            <label>Purchase Group *</label>
                            <input type="text" name="purchasingGroup_${articleCounter}" required placeholder="e.g., 112 - Footwear" style="width: 100%; padding: 8px; border: 1px solid #ced4da; border-radius: 4px;">
                        </div>
                        <div class="form-group">
                            <label>Preview URL</label>
                            <input type="url" name="articlePreview_${articleCounter}" placeholder="https://..." style="width: 100%; padding: 8px; border: 1px solid #ced4da; border-radius: 4px;">
                        </div>
                    </div>
                </div>
            `;
            
            container.appendChild(articleDiv);
        }

        // Remove article field
        function removeArticleField(id) {
            const articleDiv = document.getElementById(`article-${id}`);
            if (articleDiv) {
                articleDiv.remove();
            }
        }

        // Initialize with one article field
        document.addEventListener('DOMContentLoaded', function() {
            addArticleField();
        });
    </script>
</body>
</html>
